{% macro render_inline_fields(field, template, render, check=None) %}
  <div class="inline-field" id="{{ field.id }}">
    {# existing inline form fields #}
    <div class="inline-field-list ui segment">
      {% for subfield in field %}
        <div id="{{ subfield.id }}"
             class="inline-field ui fluid styled accordion p-relative mb-2">
          <div class="title">
            <i class="dropdown icon"></i>
            {{ field.label.text }} #{{ loop.index }}
          </div>
          <div class="content">{{ render(subfield) }}</div>
          {%- if not check or check(subfield) %}
            <div class="ui top right attached icon label">
              {% if subfield.get_pk and subfield.get_pk() %}
                <div class="ui checkbox">
                  <input type="checkbox"
                         name="del-{{ subfield.id }}"
                         id="del-{{ subfield.id }}" />
                  <label for="del-{{ subfield.id }}">
                    <span class="ui red text">{{ _gettext("Delete?") }}</span>
                  </label>
                </div>
              {% else %}
                <div value="{{ _gettext("Are you sure you want to delete this record?") }}"
                     class="inline-remove-field">
                  <i class="trash red large link icon"></i>
                </div>
              {% endif %}
            </div>
          {%- endif -%}
        </div>
      {% endfor %}
    </div>
    {# template for new inline form fields #}
    <div class="inline-field-template d-none">
      {% filter forceescape %}
        <div class="inline-field ui fluid styled accordion row p-relative mb-2">
          <div class="title">
            <i class="dropdown icon"></i>
            {{ _gettext("New") }} {{ field.label.text }}
          </div>
          <div class="content">
            {{ render(template) }}
          </div>
          <div class="ui top right attached icon label">
            <i class="inline-remove-field trash red large link icon"
               value="{{ _gettext("Are you sure you want to delete this record?") }}"></i>
          </div>
        </div>
      {% endfilter %}
    </div>
    <button id="{{ field.id }}-button"
            class="ui icon basic button"
            role="button"
            type="button"
            onclick="faForm.addInlineField(this, '{{ field.id }}');">
      <i class="plus icon"></i>
      {{ _gettext("Add") }} {{ field.label.text }}
    </button>
  </div>
{% endmacro %}
